"use strict";function t(t){return t&&t.__esModule?t:{default:t}}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),r=require("crypto"),i=t(r),u=require("path"),a=t(u),s=require("execa"),o=t(s),l=require("glob"),c=t(l),f=require("fs-jetpack"),h=t(f),d=require("listr"),g=t(d),p=require("mkdirp"),m=t(p),z=require("xdg-basedir"),v=t(z),y=a.default.join(v.default.data,"zsh_plugins");(0,m.default)(y);var w=["Tarrasch/zsh-colors","zsh-users/zsh-syntax-highlighting","zsh-users/zsh-history-substring-search","zsh-users/zsh-completions","mafredri/zsh-async","sindresorhus/pure"],k=function(){function t(n){e(this,t),this.name=n;var r=i.default.createHash("sha1");r.update(n),this.hash=r.digest("hex")}return n(t,[{key:"clonePath",get:function(){return a.default.join(y,this.hash)}}]),t}(),j=[],b=[],q=new g.default([{title:"Getting Paths for Cloning",task:function(){w=w.map(function(t){return new k(t)})}},{title:"Cleaning up",task:function(){var t=w.map(function(t){return t.hash});t.push("plugins.zsh");var e=h.default.list(y);e&&e.filter(function(e){return!t.includes(e)}).forEach(function(t){return h.default.remove(a.default.join(y,t))})}},{title:"Cloning Plugins",task:function(){return new g.default(w.map(function(t){var e=t.name,n=t.clonePath;return{title:"Cloning "+e+"...",task:function(){switch(h.default.exists(a.default.join(n,".git"))){case!1:return h.default.exists(n)&&h.default.remove(n),(0,o.default)("git",["clone","--recursive","--","https://github.com/"+e+".git",n]);case"dir":return o.default.sync("git",["fetch","--all"],{cwd:n}),(0,o.default)("git",["reset","--hard","origin/master","--"],{cwd:n});default:throw new Error("Invalid clone target!")}}}}),{concurrent:!0})}},{title:"Getting zsh File ready",task:function(){return new g.default(w.map(function(t){return{title:"Getting "+t.name+" ready...",task:function(){var e=t.name.split("/")[1],n=[e+".plugin.zsh","*.plugin.zsh","init.zsh","*.zsh","*.sh"];b.push(t.clonePath);for(var r=0;r<n.length;r++){var i=c.default.sync(a.default.join(t.clonePath,n[r]));if(0!==i.length){j.push(i[0]);break}}}}}),{concurrent:!0})}},{title:"Writing "+a.default.join(y,"plugins.zsh"),task:function(){return h.default.writeAsync(a.default.join(y,"plugins.zsh"),j.map(function(t){return"source "+t}).join("\n")+"\n"+b.map(function(t){return"fpath+="+t}).join("\n"))}}]);q.run().catch(function(t){console.error(t),process.exit(1)});
