"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,u){try{var o=t[i](u),a=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}exports.__esModule=!0,exports.cleanupTask=exports.writeTask=exports.downloadTasks=void 0,exports.writeTask=(()=>{var e=t(function*(){yield i.default.writeFile(f,`${h.join("\n")}`)});return function(){return e.apply(this,arguments)}})(),exports.cleanupTask=(()=>{var e=t(function*(){const e=[...p.map(function(e){return e.name}),"plugins.zsh"],t=yield i.default.readdir(d);t&&t.filter(function(t){return!(0,u.default)(e,t)}).forEach(function(e){return i.default.removeSync(r.default.join(d,e))})});return function(){return e.apply(this,arguments)}})();var r=e(require("path")),n=e(require("lodash/entries")),i=e(require("fs-extra")),u=e(require("lodash/includes")),o=e(require("mkdirp")),a=e(require("toml")),l=require("./index");const s=l.paths.configFile,d=l.paths.downloadDir,f=l.paths.sourceFile;(0,o.default)(d);const c=a.default.parse(i.default.readFileSync(s,"utf8")),p=(0,n.default)(c),h=Array(p.length);exports.downloadTasks=p.map((e,r)=>({title:`Downloading ${e[1].github||e[1]}...`,task:()=>t(function*(){p[r]=new l.Plugin(e),(yield i.default.pathExists(p[r].downloadPath))?yield p[r].update():yield p[r].download(),h[r]=yield p[r].entry()})()}));