"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _asyncToGenerator(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){function n(a,o){try{var r=e[a](o),u=r.value}catch(t){return void i(t)}return r.done?void t(u):Promise.resolve(u).then(function(t){n("next",t)},function(t){n("throw",t)})}return n("next")})}}exports.__esModule=!0,exports.Plugin=exports.paths=void 0;var _path=require("path"),_path2=_interopRequireDefault(_path),_execa=require("execa"),_execa2=_interopRequireDefault(_execa),_findupSync=require("findup-sync"),_findupSync2=_interopRequireDefault(_findupSync),_isString=require("lodash/isString"),_isString2=_interopRequireDefault(_isString),_isFunction=require("lodash/isFunction"),_isFunction2=_interopRequireDefault(_isFunction),_xdgBasedir=require("xdg-basedir"),_xdgBasedir2=_interopRequireDefault(_xdgBasedir);const t=exports.paths={downloadDir:_path2.default.join(_xdgBasedir2.default.data,"zsh-goggles"),configFile:_path2.default.join(_xdgBasedir2.default.config,"zsh-goggles","config.js"),sourceFile:_path2.default.join(_xdgBasedir2.default.data,"zsh-goggles","plugins.zsh")};class e{constructor([e,i]){this.name=e,this.downloadPath=_path2.default.join(t.downloadDir,e),(0,_isString2.default)(i)?this.github=i:(this.github=i.github,this._sourceFile=i.source,this._fpath=i.fpath)}get fpath(){const t=this._fpath;if(t!==!1)return(0,_isString2.default)(t)?_path2.default.join(this.downloadPath,t):(0,_isFunction2.default)(t)?t(this.downloadPath):this.downloadPath}get sourceFile(){const t=this._sourceFile;if(t!==!1){if((0,_isString2.default)(t))return _path2.default.join(this.downloadPath,t);if((0,_isFunction2.default)(t))return t(this.downloadPath);const e=[`${this.uniqueName}?(.plugin).?(z)sh`,"*.plugin.zsh","init.zsh","*.zsh","*.sh"];return(0,_findupSync2.default)(e,{cwd:this.downloadPath,nocase:!0,maxdepth:0})}}download(){var t=this;return _asyncToGenerator(function*(){yield(0,_execa2.default)("git",["clone","--recursive","--",`https://github.com/${t.github}.git`,t.downloadPath])})()}update(){var t=this;return _asyncToGenerator(function*(){yield(0,_execa2.default)("git",["fetch","--all"],{cwd:t.downloadPath}),yield(0,_execa2.default)("git",["reset","--hard","origin/master","--"],{cwd:t.downloadPath})})()}}exports.Plugin=e;